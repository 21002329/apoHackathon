<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootswatch/4.3.1/flatly/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>


    <!-- Numeric JS -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/numeric/1.2.6/numeric.min.js"></script>


    <!-- timesheet -->
      <style>
        canvas {
          -moz-user-select: none;
          -webkit-user-select: none;
          -ms-user-select: none;
        }
      </style>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
      <script src="./js/Chart.min.js"></script>
      <script src="./js/Chart_utils.js"></script>


    <style>img.bannerApoBank{
      max-width:80%;
      max-height:80%;
    }</style>

    <!-- own java script stuff -->
    <script type = "text/javascript" src="./js/utils.js"></script>
    <script>
        function closeRecommendation(){
            $('#user_action').hide();
        };
    </script>

    <script>
      function doSomething(){

        finoRefreshToken();
		    var minPerc2Invest = 30;
		    var maxPercFixedCost = 50;

        var data = getSpendingsPieChartData();
        var data_round = data.values;
        var x= 0;
        while(x < data_round.length){
            data_round[x] = data_round[x].toFixed(2);
            x++
        }
        var data_abs_Expensen = getSpendingsExpensenTable();
        var data_abs_round = data_abs_Expensen.values;
        var x= 0;
        while(x < data_abs_round.length){
            data_abs_round[x] = data_abs_round[x].toFixed(2);
            x++
        }

        // avg doctors
        var docs ={
            header: ['others','travel','health','insurence','rental'],
            doc: [[420,450,45,220,980],
            [332,1600,89,260,1200],
            [520,180,120,450,652],
            [510,276,210,420,742],
            [310,870,20,378,520],
            [467,125,0,255,547]]
        };

        var avg_doc = Array(docs.header.length).fill(0);
        var itx = 0;
        var iter2 = 0;
        while( itx < docs.header.length ){
          while(iter2 < 6){
            avg_doc[itx] += docs.doc[iter2][itx]

            iter2 += 1;
          }
          avg_doc[itx] = avg_doc[itx] / (iter2 -1);
          iter2 = 0;
          itx += 1;
        }


        Plotly.newPlot('Expenses', [data],{
          title: 'Top 5 Expenses',
          width: document.documentElement.clientWidth * 0.30,
          margin:{l: 10,r: 10,b: 10,t: 50,pad: 10},
          paper_bgcolor: 'rgba(0,0,0,0)',
          plot_bgcolor: 'rgba(0,0,0,0)',
          showlegend: false
        }, {showSendToCloud: false});

        var rowEvenColor = "#96A9C1";
        var rowOddColor = 'rgba(0,0,0,0)';
        var data_Table_Expenses = [{
          type: 'table',
          header: {
            values: [["<b>Kategorie</b>"],["<b>%-Anteil</b>"], ["<b>Total</b>"], ["<b>AVG-Arzt</b>"]],
            align: "center",
            line: {width: 0, color: '#FFFFFF'},
            fill: {color: 'rgba(0,0,0,0)'},
            font: {family: "Arial", size: 18, color: "black"}
          },
          cells: {
            values: [data_abs_Expensen.labels,data_round,data_abs_round,avg_doc],
            align: "center",
            line: {color: "#FFFFFF", width: 0},
            fill: {color: [[rowEvenColor,rowOddColor,rowEvenColor,
                      rowOddColor,rowEvenColor,rowOddColor]]},
            font: {family: "Arial", size: 16, color: ["black"]}
          }
        }]

        Plotly.plot('Table_Expenses',data_Table_Expenses,{title: 'Top 5 Expenses',
                                                          width: document.documentElement.clientWidth * 0.25,margin:{l: 5,r: 5,b: 1,t: 80,pad: 10},
                                                          paper_bgcolor: 'rgba(0,0,0,0)',
                                                          plot_bgcolor: 'rgba(0,0,0,0)'},
                                                        {showSendToCloud: false});

          temp = getAccountBalancePlotData();

					var ctx = document.getElementById('chart1').getContext('2d');
					ctx.canvas.width = 1000;
					ctx.canvas.height = 300;

					var color = Chart.helpers.color;
					var cfg = {
						type: 'bar',
						data: {
							datasets: [{
								label: 'My Account Balance and Forcast',
								backgroundColor: color(window.chartColors.green).alpha(0.5).rgbString(),
								borderColor: window.chartColors.green,
								data: temp,
								type: 'line',
								pointRadius: 0,
								fill: false,
								lineTension: 0,
								borderWidth: 2
							}]
						},
						options: {
							scales: {
								xAxes: [{
									type: 'time',
									distribution: 'series',
									time: {
										unit: 'day',
									}
								}],
								yAxes: [{
									scaleLabel: {
										display: true,
										labelString: 'Amount in €'
									}
								}]
							},
							tooltips: {
								intersect: false,
								mode: 'index',
								callbacks: {
									label: function(tooltipItem, myData) {
										var label = myData.datasets[tooltipItem.datasetIndex].label || '';
										if (label) {
											label += ': ';
										}
										label += parseFloat(tooltipItem.value).toFixed(2);
										return label;
									}
								}
							}
						}
					};

					var chart = new Chart(ctx, cfg);

					document.getElementById('update').addEventListener('click', function() {
						var type = document.getElementById('type').value;
						chart.config.data.datasets[0].type = type;
						chart.update();
					});

        $('#loginButton').hide();
        $('#main').show();

        //window.location.href = "./banking_home.html";
      }
    </script>
    <title>apoBank Hackathon</title>
  </head>



<body style="padding-top: 70px">
    <nav class="navbar navbar-expand-lg fixed-top navbar-dark bg-primary">
      <a class="navbar-brand" href="#">apoBank</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor01" aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarColor01">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item active">
            <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
          </li>
        </ul>

        <button id="loginButton" class="btn btn-secondary my-2 my-sm-0" type="button" onclick="doSomething()">Login</button>
      </div>
    </nav>



<div id="main" class="container">
      <div id="banner" class="page-header" style="padding: 20px">
        <div class="row">
          <div class="col-lg-8 col-sm-6">
            <h3 class="display-5">Hello Annika Pauder!<br>Hier die aktuelle Finanzübersicht</h3>
          </div>

           <div class="col-lg-4 col-sm-6">
              <img class="bannerApoBank" src="./img/banner.png" align="right">
          </div>
        </div>
      </div>

      <div id="dashboard_Statistic" class="bs-docs-section">
          <div class="bs-component">
          <div class="jumbotron">
          <h2 class="display-5">Kontostatistiken</h2>
            <div class="row">
                <div class="col-6">
                      <div id="Expenses">
                          <!-- Plotly chart will be drawn inside this DIV -->
                      </div>
                </div>
                <div class="col-6">
                      <div id="Table_Expenses">
                        <!-- Plotly chart will be drawn inside this DIV -->
                      </div>
              </div>
              </div>
        </div>
      </div>
      </div>


      <div id="user_action">
      <div class="row">
      <div class="container">
          <div id="Blog_Recomm" class="alert alert-dismissible alert-primary">
            <button type="button" class="close" data-dismiss="alert" onclick="closeRecommendation()">&times;</button>
            <h4 class="alert-heading"></h4>

            <div class="row">
              <div class="col-sm-1">
                <button id = "firstAdvice" type="button" class="btn btn-primary"><font size="8">&#11146;</font></button>
              </div>
              <div class="col-lg-10">
                Sie bezahlen mehr für Ihre Versicherungen als die Vergleichsgruppe von Personen mit Ihrem Beruf aus Ihrer Gegend. Klicken Sie auf den Pfeil um einen Termin mit einem unserer Berater einen Termin zu vereinbaren.
              <p align='right'>
                   <button type="button" id="Btn_more_recomm" class="btn btn-secondary" data-toggle="modal" data-target="#myModal">Learn more</button>
              </p>
              </div>
            </div>
          </div>
      </div>
      </div>
      </div>

              <!-- Modal -->
               <div class="modal" id="myModal">
                  <div class="modal-dialog modal-lg">
                    <div class="modal-content">

                      <!-- Modal Header -->
                      <div class="modal-header">
                        <h4 class="modal-title">Versicherungswechsel Optionen</h4>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                      </div>

                      <!-- Modal body -->
                      <div class="modal-body container">
                         <div class="row">
                            <div class="col-sm-6">
                            <div class="card border-primary mb-3" style="max-width: 20rem;">
                              <div class="card-header">Absicherung rundum</div>
                              <div class="card-body">
                                <h4 class="card-title">Versicherungen</h4>
                                <p class="card-text">Der Beruf und das Privatleben halten viele Chancen und Optionen bereit, die ausgetestet werden wollen. Lassen Sie sich die spannenden Herausforderungen nicht entgehen, die für Sie persönlich wichtig sind</p>
                                <a class="btn btn-secondary" href="https://www.apobank.de/angestellte/versicherung-vorsorge_ang/versichern_ang.html" role="button">Learn more</a>
                              </div>
                            </div>
                            </div>

                            <div class="col-sm-6">
                            <div class="card border-primary mb-3" style="max-width: 20rem;">
                              <div class="card-header">Versicherungspaket der apoPlatinumCard</div>
                              <div class="card-body">
                                <h4 class="card-title">Mit Sicherheit entspannter reisen</h4>
                                <p class="card-text">Die apoBank hat für Inhaber der apoPlatinumCard ein umfassendes Versicherungspaket abgeschlossen. Diese nahtlos aufeinander abgestimmten Leistungen machen das Reisen für Sie noch sicherer und entspannter.</p>
                                <a class="btn btn-secondary" href="https://www.apobank.de/geldanlage-vermoegen/private-banking/apoplatinum/versicherungen.html" role="button">Learn more</a>
                              </div>
                            </div>
                            </div>
                        </div>
                      </div>

                      <!-- Modal footer -->
                      <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                      </div>

                    </div>
                  </div>
                </div>


      <div id="dashboard_Forecast" class="bs-docs-section">
      <div class="bs-component">
          <div class="jumbotron">
          <div class="row">
          <h2 class="display-5">Entwicklung der Kontobilanz</h2>

                <canvas id="chart1"></canvas> <!-- Chart will be drawn inside this DIV -->

                        Chart Type:
                        <select id="type">
                          <option value="line">Line</option>
                          <option value="bar">Bar</option>
                        </select>
                        <button id="update">update</button>
           </div>

           <hr class="my-3">
                  <p class="lead">
                    <a class="btn btn-primary btn-lg" href="#" role="button">Learn more</a>
                  </p>
         </div>
      </div>
      </div>

    <div id="user_action">
    <div class="row">
      <div class="container">
        <div id="Blog_Recomm" class="alert alert-dismissible alert-primary">
            <button type="button" class="close" data-dismiss="alert" onclick="closeRecommendation()">&times;</button>
            <h4 class="alert-heading"></h4>

            <div class="row">
              <div class="col-sm-1">
						  <button id= "secondAdvice"  type="button"  onclick="openAdvice2()" class="btn btn-primary"><font size="8">&#11147;</font></button>
              </div>
              <div class="col-lg-10">
                Sie können Ihre freies Kapital auf ein Tagesgeldkonto verschieben.
                <p align="left">
                     Risk Level 1
                </p>
                  <p align='right'>
                       <button type="button" id="Btn_more_recomm" class="btn btn-secondary" data-toggle="modal" data-target="#myFirstAdvise">Learn more</button>
                  </p>
              </div>
            </div>
          </div>

                      <!-- Modal -->
               <div class="modal" id="myFirstAdvise">
                  <div class="modal-dialog modal-lg">
                    <div class="modal-content">

                      <!-- Modal Header -->
                      <div class="modal-header">
                        <h4 class="modal-title">Tagesgeldkonto</h4>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                      </div>

                      <!-- Modal body -->
                      <div class="modal-body container">


                      </div>
                      <!-- Modal footer -->
                      <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                      </div>

                    </div>
                  </div>
                </div>




          <div id="Blog_Recomm" class="alert alert-dismissible alert-primary">
              <button type="button" class="close" data-dismiss="alert" onclick="closeRecommendation()">&times;</button>
              <h4 class="alert-heading"></h4>

              <div class="row">
                <div class="col-sm-1">
                  <button id = "secondAdvice" type="button" onclick="openAdvice3()" class="btn btn-primary"><font size="8">&#11146;</font></button>
                </div>
                <div class="col-lg-10">
                   Mit unserer Hilfe können Sie ihr freies Kapital in nur wenigen Minuten Gewinnbringen anlegen.
                   <p align="left">
                     Risk Level 3
                    </p>
                    <p align='right'>
                         <button type="button" id="Btn_more_recomm" class="btn btn-secondary" data-toggle="modal" data-target="#mySecAdvise">Learn more</button>
                    </p>
                </div>
              </div>
          </div>

                                    <!-- Modal -->
               <div class="modal" id="mySecAdvise">
                  <div class="modal-dialog modal-lg">
                    <div class="modal-content">

                      <!-- Modal Header -->
                      <div class="modal-header">
                        <h4 class="modal-title">Anlage</h4>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                      </div>

                      <!-- Modal body -->
                      <div class="modal-body container">


                      </div>
                      <!-- Modal footer -->
                      <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                      </div>

                    </div>
                  </div>
                </div>


			<script>
				function openAdvice2(){
					window.location.href = "https://www.apobank.de/angestellte/konto_und_kreditkarten_ang/tagesgeld_ang.html";
				}
				function openAdvice3(){
					window.location.href = "./advice.html";
				}
			</script>



    </div>
	</div>
	</div>


</div>

    <script>
      $(document).ready(function(){
        $('#main').hide();
      });

    </script>

  </body>
</html>
