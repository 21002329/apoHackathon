<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootswatch/4.3.1/flatly/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Numeric JS -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/numeric/1.2.6/numeric.min.js"></script>


    <!-- timesheet -->
      <style>
        canvas {
          -moz-user-select: none;
          -webkit-user-select: none;
          -ms-user-select: none;
        }
      </style>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
      <script src="./js/Chart.min.js"></script>
      <script src="./js/Chart_utils.js"></script>


    <style>img.bannerApoBank{
      max-width:80%;
      max-height:80%;
    }</style>

    <!-- own java script stuff -->
    <script type = "text/javascript" src="./js/utils.js"></script>
    <script>
      function doSomething(){
        finoRefreshToken();
		    var minPerc2Invest = 30;
		    var maxPercFixedCost = 50;

        var data = getSpendingsPieChartData();
        var data_round = data.values;
        var x= 0;
        while(x < data_round.length){
            data_round[x] = data_round[x].toFixed(2);
            x++
        }
        var data_abs_Expensen = getSpendingsExpensenTable();
        var data_abs_round = data_abs_Expensen.values;
        var x= 0;
        while(x < data_abs_round.length){
            data_abs_round[x] = data_abs_round[x].toFixed(2);
            x++
        }


        Plotly.newPlot('Expenses', [data],{
          title: 'Top 5 Expenses',
          width: document.documentElement.clientWidth * 0.30,
          margin:{l: 10,r: 10,b: 10,t: 50,pad: 10},
          paper_bgcolor: 'rgba(0,0,0,0)',
          plot_bgcolor: 'rgba(0,0,0,0)',
          showlegend: false
        }, {showSendToCloud: false});

        var rowEvenColor = "#96A9C1";
        var rowOddColor = 'rgba(0,0,0,0)';
        var data_Table_Expenses = [{
          type: 'table',
          header: {
            values: [["<b>Kategorie</b>"],["<b>%-Anteil</b>"], ["<b>Total</b>"]],
            align: "center",
            line: {width: 0, color: '#FFFFFF'},
            fill: {color: 'rgba(0,0,0,0)'},
            font: {family: "Arial", size: 12, color: "black"}
          },
          cells: {
            values: [data_abs_Expensen.labels,data_round,data_abs_round],
            align: "center",
            line: {color: "#FFFFFF", width: 0},
            fill: {color: [[rowEvenColor,rowOddColor,rowEvenColor,
                      rowOddColor,rowEvenColor,rowOddColor]]},
            font: {family: "Arial", size: 11, color: ["black"]}
          }
        }]

        Plotly.plot('Table_Expenses',data_Table_Expenses,{title: 'Top 5 Expenses',
                                                          width: document.documentElement.clientWidth * 0.25,margin:{l: 5,r: 5,b: 1,t: 80,pad: 10},
                                                          paper_bgcolor: 'rgba(0,0,0,0)',
                                                          plot_bgcolor: 'rgba(0,0,0,0)'},
                                                        {showSendToCloud: false});

          temp = getAccountBalancePlotData();

					var ctx = document.getElementById('chart1').getContext('2d');
					ctx.canvas.width = 1000;
					ctx.canvas.height = 300;

					var color = Chart.helpers.color;
					var cfg = {
						type: 'bar',
						data: {
							datasets: [{
								label: 'My Account Balance and Forcast',
								backgroundColor: color(window.chartColors.green).alpha(0.5).rgbString(),
								borderColor: window.chartColors.green,
								data: temp,
								type: 'line',
								pointRadius: 0,
								fill: false,
								lineTension: 0,
								borderWidth: 2
							}]
						},
						options: {
							scales: {
								xAxes: [{
									type: 'time',
									distribution: 'series',
									time: {
										unit: 'day',
									}
								}],
								yAxes: [{
									scaleLabel: {
										display: true,
										labelString: 'Amount in €'
									}
								}]
							},
							tooltips: {
								intersect: false,
								mode: 'index',
								callbacks: {
									label: function(tooltipItem, myData) {
										var label = myData.datasets[tooltipItem.datasetIndex].label || '';
										if (label) {
											label += ': ';
										}
										label += parseFloat(tooltipItem.value).toFixed(2);
										return label;
									}
								}
							}
						}
					};

					var chart = new Chart(ctx, cfg);

					document.getElementById('update').addEventListener('click', function() {
						var type = document.getElementById('type').value;
						chart.config.data.datasets[0].type = type;
						chart.update();
					});

        $('#loginButton').hide();
        $('#main').show();

        //window.location.href = "./banking_home.html";
      }
    </script>
    <title>apoBank Hackathon</title>
  </head>



<body style="padding-top: 70px">
    <nav class="navbar navbar-expand-lg fixed-top navbar-dark bg-primary">
      <a class="navbar-brand" href="#">apoBank</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor01" aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarColor01">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item active">
            <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
          </li>
        </ul>

        <button id="loginButton" class="btn btn-secondary my-2 my-sm-0" type="button" onclick="doSomething()">Login</button>
      </div>
    </nav>



<div id="main" class="container">
      <div id="banner" class="page-header" style="padding: 20px">
        <div class="row">
          <div class="col-lg-8 col-sm-6">
            <h3 class="display-5">Hello Annika Pauder!<br>Hier die aktuelle Finanzübersicht</h3>
          </div>

           <div class="col-lg-4 col-sm-6">
              <img class="bannerApoBank" src="./img/banner.png" align="right">
          </div>
        </div>
      </div>

      <div id="dashboard" class="bs-docs-section">
          <div class="bs-component">
          <div class="jumbotron">
          <h2 class="display-5">Kontostatistiken</h2>
            <div class="row">
                <div class="col-6">
                      <div id="Expenses">
                          <!-- Plotly chart will be drawn inside this DIV -->
                      </div>
                </div>
                <div class="col-6">
                      <div id="Table_Expenses">
                        <!-- Plotly chart will be drawn inside this DIV -->
                      </div>
              </div>
              </div>

          <div class="row">
          <h2 class="display-5">Entwicklung der Kontobilanz</h2>

                <canvas id="chart1"></canvas> <!-- Chart will be drawn inside this DIV -->

                        Chart Type:
                        <select id="type">
                          <option value="line">Line</option>
                          <option value="bar">Bar</option>
                        </select>
                        <button id="update">update</button>
           </div>

           <hr class="my-3">
                  <p class="lead">
                    <a class="btn btn-primary btn-lg" href="#" role="button">Learn more</a>
                  </p>
        </div>
      </div>
    </div>

    <div id="user_action">
    <div class="row">
      <div class="container">
			<div class="btn-group-vertical">
				<div class="btn-group-vertical">
					<div class="btn-group">
						<button id = "firstAdvice" type="button" class="btn btn-primary" onclick="openAdvice1()"><font size="8">&#11146;</font></button>
						<button id = "firstAdviceText" type="button" class="btn btn-primary" onclick="openAdvice1()"></button>
						<p  id ="firstAdviceTextFull"> Sie bezahlen mehr für Ihre Versicherungen als die Vergleichsgruppe von Personen mit Ihrem Beruf aus Ihrer Gegend. Klicken Sie auf den Pfeil um einen Termin mit einem unserer Berater einen Termin zu vereinbaren.</p>
					</div>
					<p id = "riskFirstAdvice">  </p>
				</div>
				<div class="btn-group-vertical">

					<div class="btn-group">
						<button id= "secondAdvice"  type="button"  onclick="openAdvice2()" class="btn btn-primary"><font size="8">&#11147;</font></button>
						<button id= "secondAdviceText"  type="button"  onclick="openAdvice2()" class="btn btn-primary"></button>
						<p  id ="secondAdviceTextFull">Sie können Ihre freies Kapital auf ein Tagesgeldkonto verschieben.</p>
					</div>
					<p id = "riskSecondAdvice">  </p>

				</div>
				<div class="btn-group-vertical">

					<div class="btn-group">
						<button id ="thirdAdvice" type="button"  onclick="openAdvice3()" class="btn btn-primary"><font size="8">&#11147;</font></button>
						<button id ="thirdAdviceText" type="button"  onclick="openAdvice3()" class="btn btn-primary"></button>
						<p  id ="thirdAdviceTextFull"> Mit unserer Hilfe können Sie ihr freies Kapital in nur wenigen Minuten Gewinnbringen anlegen.</p>
	
					</div>
					<p id = "riskThirdAdvice">  </p>
				</div>
			
			</div>

			<script>
			
				document.getElementById("firstAdviceText").innerHTML = "Mit Versicherungswechsel Geld sparen";
				document.getElementById("riskFirstAdvice").innerHTML = "Risk Level 0"
				document.getElementById("secondAdviceText").innerHTML = "Freies Kapital auf ein Tagesgeldkonto verschieben";
				document.getElementById("riskSecondAdvice").innerHTML = "Risk Level 1"
				document.getElementById("thirdAdviceText").innerHTML = "Freies Kapital anlegen.";
				document.getElementById("riskThirdAdvice").innerHTML = "Risk Level 3"

				function openAdvice1(){
					window.location.href = "https://www.apobank.de/selbstaendige/versicherung-vorsorge_sel/versicherung_sel.html";
				}
				function openAdvice2(){
					window.location.href = "https://www.apobank.de/angestellte/konto_und_kreditkarten_ang/tagesgeld_ang.html";
				}
				function openAdvice3(){
					window.location.href = "./advice.html";
				}
			</script>
			
          
          
          </div>	  
	  </div>
	</div>
	</div>
	  
    <script>
      $(document).ready(function(){
        $('#main').hide();
      });

    </script>

  </body>
</html>
